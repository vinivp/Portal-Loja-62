<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/estilo.css">
  <title>Criador de Cartazes</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
      font-family: 'Segoe UI', sans-serif;
    }
    .container-box {
      max-width: 800px;
      margin: 30px auto;
      background-color: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .cartaz {
      margin-top: 30px;
      padding: 40px;
      border: 3px solid #333;
      text-align: center;
      font-size: 2rem;
      font-weight: bold;
      background-image: url('image.png');
    }
    .cartaz.oferta {
      background-color: #f8d7da;
      color: #721c24;
      border-color: #f5c6cb;
    }
    .cartaz.normal {
      background-color: #d1ecf1;
      color: #0c5460;
      border-color: #bee5eb;
    }
    .cartaz .preco {
      font-size: 3rem;
      margin-top: 15px;
    }
    .validade {
      font-size: 1rem;
      margin-top: 10px;
      font-weight: normal;
    }
  </style>
</head>
<body>

  <div class="container-box">
    <h3 class="text-center mb-4">üñ®Ô∏è Criador de Cartazes</h3>

    <form id="formCartaz">
      <div class="mb-3">
        <label for="descricao" class="form-label">Descri√ß√£o do Produto</label>
        <input type="text" class="form-control" id="descricao" required>
      </div>

      <div class="mb-3">
        <label for="preco" class="form-label">Pre√ßo</label>
        <input type="text" class="form-control" id="preco" placeholder="Ex: R$ 9,99" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Tipo de Cartaz</label>
        <select class="form-select" id="tipoCartaz">
          <option value="oferta">Oferta</option>
          <option value="normal">Sem Oferta</option>
        </select>
      </div>

      <div class="mb-3">
        <label for="validadeDias" class="form-label">Validade (em dias)</label>
        <input type="number" class="form-control" id="validadeDias" placeholder="Ex: 10">
        <small class="text-muted">Digite o n√∫mero de dias e o sistema calcular√° a data final.</small>
      </div>

      <button type="submit" class="btn btn-danger w-100">üßæ Gerar Cartaz</button>
    </form>

    <button type="button" class="btn btn-success w-100 mt-3" onclick="baixarPDF()">üì• Baixar em A4</button>

    <!-- Aqui ser√° gerado o cartaz -->
    <div id="cartazGerado" class="cartaz d-none"></div>
  </div>

  <!-- Bibliotecas necess√°rias -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <script>
    document.getElementById("formCartaz").addEventListener("submit", function(e) {
      e.preventDefault();

      const descricao = document.getElementById("descricao").value;
      const preco = document.getElementById("preco").value;
      const tipo = document.getElementById("tipoCartaz").value;
      const validadeDias = parseInt(document.getElementById("validadeDias").value);

      let validadeTexto = "";
      if (!isNaN(validadeDias) && validadeDias > 0) {
        const hoje = new Date();
        hoje.setDate(hoje.getDate() + validadeDias);
        const dia = String(hoje.getDate()).padStart(2, "0");
        const mes = String(hoje.getMonth() + 1).padStart(2, "0");
        const ano = hoje.getFullYear();
        validadeTexto = `Validade: at√© ${dia}/${mes}/${ano}`;
      }

      const cartaz = document.getElementById("cartazGerado");
      cartaz.className = "cartaz " + tipo;

      if (tipo === "oferta") {
        cartaz.innerHTML = `
          <div class="titulo-oferta">OFERTA</div>
          <div class="descricao">${descricao}</div>
          <div class="preco">${preco}</div>
          ${validadeTexto ? `<div class="validade">${validadeTexto}</div>` : ""}
        `;
      } else {
        cartaz.innerHTML = `
          <div class="descricao">${descricao}</div>
          <div class="preco">${preco}</div>
          ${validadeTexto ? `<div class="validade">${validadeTexto}</div>` : ""}
        `;
      }

      cartaz.classList.remove("d-none");
    });

    async function baixarPDF() {
      const cartaz = document.getElementById("cartazGerado");
      if (cartaz.classList.contains("d-none")) {
        alert("Primeiro gere o cartaz!");
        return;
      }

      const canvas = await html2canvas(cartaz, { scale: 2 });
      const imgData = canvas.toDataURL("image/png");

      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF("p", "mm", "a4");

      const pageWidth = 210;  // largura A4 em mm
      const imgProps = pdf.getImageProperties(imgData);
      const imgWidth = pageWidth;
      const imgHeight = (imgProps.height * imgWidth) / imgProps.width;

      pdf.addImage(imgData, "PNG", 0, 20, imgWidth, imgHeight);
      pdf.save("cartaz.pdf");
    }
  </script>

</body>



</html>